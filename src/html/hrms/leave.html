<!doctype html>
<html lang="en" @@bodySetup>
  <head>
    @@include('../layouts/head-page-meta.html', {'title': 'Leave Management - INGENZI HRMS'})
    @@include('../layouts/head-css.html')
  </head>
  <body>
    @@include('../layouts/layout-vertical.html')

    <div class="pc-container">
      <div class="pc-content">
        @@include('../layouts/breadcrumb.html', {'breadcrumb-item': 'HR Management', 'breadcrumb-item-active': 'Leave Management'})
        
        <div class="grid grid-cols-12 gap-x-6">
          <div class="col-span-12">
            <div class="card">
              <div class="card-header flex items-center justify-between">
                <h5>Leave Management</h5>
                <button class="btn btn-primary" id="applyLeaveBtn" style="display: none;">
                  <i class="feather icon-plus me-2"></i>Apply for Leave
                </button>
              </div>
              <div class="card-body">
                <!-- Leave Status Alert (for employees) -->
                <div id="leaveStatusAlert" class="mb-4" style="display: none;"></div>
                
                <!-- Tabs -->
                <div class="flex gap-2 mb-4 border-b">
                  <button class="nav-tab px-4 py-2" id="historyTab">Leave History</button>
                  <button class="nav-tab px-4 py-2" id="applyTab" style="display: none;">Apply for Leave</button>
                  <button class="nav-tab active px-4 py-2" id="requestsTab" data-role="hr_manager system_admin">Leave Requests</button>
                </div>

                <!-- Leave Requests Tab -->
                <div id="requestsView">
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <thead>
                        <tr>
                          <th id="employeeHeader" data-role="hr_manager system_admin">Employee</th>
                          <th>Leave Type</th>
                          <th>Start Date</th>
                          <th>End Date</th>
                          <th>Days</th>
                          <th>Reason</th>
                          <th>Status</th>
                          <th id="actionsHeader" data-role="hr_manager system_admin">Actions</th>
                        </tr>
                      </thead>
                      <tbody id="leaveRequestsContainer">
                        <!-- Leave requests will be loaded here -->
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- Apply for Leave Tab -->
                <div id="applyView" style="display: none;">
                  <div class="max-w-2xl">
                    <form id="leaveForm">
                      <div class="grid grid-cols-12 gap-4">
                        <div class="col-span-12 md:col-span-6">
                          <label class="form-label">Leave Type</label>
                          <select class="form-control" id="leaveTypeId" required>
                            <option value="">Select Leave Type</option>
                          </select>
                        </div>
                        <div class="col-span-12 md:col-span-6">
                          <label class="form-label">Start Date</label>
                          <input type="date" class="form-control" id="startDate" required />
                        </div>
                        <div class="col-span-12 md:col-span-6">
                          <label class="form-label">End Date</label>
                          <input type="date" class="form-control" id="endDate" required />
                        </div>
                        <div class="col-span-12">
                          <label class="form-label">Reason</label>
                          <textarea class="form-control" id="reason" rows="3" required></textarea>
                        </div>
                        <div class="col-span-12">
                          <button type="submit" class="btn btn-primary">Submit Leave Request</button>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>

                <!-- Leave History Tab -->
                <div id="historyView" style="display: none;">
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <thead>
                        <tr>
                          <th id="historyEmployeeHeader" data-role="hr_manager system_admin">Employee</th>
                          <th>Leave Type</th>
                          <th>Start Date</th>
                          <th>End Date</th>
                          <th>Days</th>
                          <th>Reason</th>
                          <th>Status</th>
                          <th>Processed Date</th>
                        </tr>
                      </thead>
                      <tbody id="leaveHistoryContainer">
                        <!-- Leave history will be loaded here -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <style>
      .nav-tab {
        background: none;
        border: none;
        border-bottom: 2px solid transparent;
        cursor: pointer;
        color: #6b7280;
        transition: all 0.3s;
      }
      .nav-tab:hover {
        color: #3b82f6;
      }
      .nav-tab.active {
        color: #3b82f6;
        border-bottom-color: #3b82f6;
      }
    </style>

    @@include('../layouts/footer-block.html')
    @@include('../layouts/footer-js.html')
    <script src="../assets/js/api.js"></script>
    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/toast.js"></script>
    <script src="../assets/js/leave.js"></script>
  </body>
</html>
